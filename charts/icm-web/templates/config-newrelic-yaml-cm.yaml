{{- if .Values.agent.newrelic.enabled -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "icm-web.fullname" . }}-newrelic-yml
  labels:
    {{- include "icm-web.labels" . | nindent 4 }}
data:
  newrelic.yml:  |-
    common: &default_settings
      app_name: "{{ template "icm-web.fullname" . }}-webadapter"
      application_logging:
        enabled: true
        forwarding:
          enabled: false
          max_samples_stored: 10000
          context_data:
            enabled: false
            include:
            exclude:
        metrics:
          enabled: {{ .Values.agent.newrelic.metrics.enabled }}
        local_decorating:
          enabled: true
{{- end -}}
