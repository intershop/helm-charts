<report-config>

    <aggregators>
        <aggregator>
            <name>WALogs</name>
            <description>Export the web adapter access logs</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>cluster</scope>
            <max-age>168</max-age>
            <max-space></max-space>
            <file-name-pattern>WA-[a-zA-Z0-9\-\.]+\.log$</file-name-pattern>
            <directories>$ISSHARELOG</directories>
            <recursive>false</recursive>
            <compression-mode>single-files</compression-mode>
            <init-schedule>
                <run-time>2006.11.16 at 04:00:00</run-time>
                <recurrence-pattern>
                    <in>hours</in>
                    <every>24</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>WAStatistics</name>
            <description>Export the web adapter statistics logs</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>cluster</scope>
            <max-age>168</max-age>
            <max-space></max-space>
            <file-name-pattern>wastatistics-.*\.log$</file-name-pattern>
            <directories>$ISSHARELOG</directories>
            <recursive>false</recursive>
            <compression-mode>single-files</compression-mode>
            <init-schedule>
                <run-time>2006.11.16 at 04:40:00</run-time>
                <recurrence-pattern>
                    <in>hours</in>
                    <every>24</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>AppServerLogs</name>
            <description>Export all logfiles generated by the application servers</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>cluster</scope>
            <max-age>168</max-age>
            <max-space></max-space>
			<file-name-pattern>(error|fatal)-[a-zA-Z0-9\-]+.*\.zip$</file-name-pattern>
            <directories>$ISSHARELOG</directories>
            <recursive>false</recursive>
            <compression-mode></compression-mode>
            <init-schedule>
                <run-time>2006.11.16 at 04:05:00</run-time>
                <recurrence-pattern>
                    <in>hours</in>
                    <every>24</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>LogsLocal</name>
            <description>Export the log files from the $ISHOME/log directory</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>installation</scope>
            <max-space></max-space>
            <file-name-pattern>.*\.log$</file-name-pattern>
            <directories>$ISHOME/log</directories>
            <recursive>false</recursive>
            <compression-mode>single-files</compression-mode>
            <init-schedule>
                <run-time>2006.11.16 at 04:10:00</run-time>
                <recurrence-pattern>
                    <in>hours</in>
                    <every>24</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator os.name="sunos,hp-ux,windows">
            <name>InstallationInformationLocal</name>
            <description>Export all ".xml" and ".log" files found in .install directory of the specified instance</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>installation</scope>
            <file-name-pattern>.*\.(xml|log)$</file-name-pattern>
            <directories>$SYSTEM_DEFAULT_INSTALL_DIR/intershop;$ISHOME/.install</directories>
            <recursive>true</recursive>
            <synchronize>true</synchronize>
            <compression-mode>complete-data-directory</compression-mode>
            <init-schedule>
                <run-time>2006.04.21 at 04:15:00</run-time>
                <recurrence-pattern>
                    <in>weeks</in>
                    <every>2</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator os.name="sunos,hp-ux,windows">
            <name>InstallationInformationShare</name>
            <description>Export all ".xml" and ".log" files found in the .install directory of the shared file system</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>cluster</scope>
            <file-name-pattern>.*\.(xml|log)$</file-name-pattern>
            <directories>$ISSHAREDIR/.install</directories>
            <recursive>true</recursive>
            <synchronize>true</synchronize>
            <compression-mode>complete-data-directory</compression-mode>
            <init-schedule>
                <run-time>2006.04.21 at 04:20:00</run-time>
                <recurrence-pattern>
                    <in>weeks</in>
                    <every>2</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>PropertyFilesShare</name>
            <description>Export all ".properties" files found in $ISSHAREDIR. It also creates a property change log file.</description>
            <class>com.intershop.beehive.report.internal.aggregators.propertyfiles.PropertyFilesAggregator</class>
            <scope>cluster</scope>
            <file-name-pattern>.*\.properties$</file-name-pattern>
            <directories>$ISSHAREDIR</directories>
            <recursive>true</recursive>
            <synchronize>true</synchronize>
            <compression-mode>complete-data-directory</compression-mode>
            <init-schedule>
                <run-time>2006.01.16 at 04:25:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>1</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>PropertyFilesLocal</name>
            <description>Export all ".properties" files found in the specified instance. It also creates a property change log file.</description>
            <class>com.intershop.beehive.report.internal.aggregators.propertyfiles.PropertyFilesAggregator</class>
            <scope>installation</scope>
            <file-name-pattern>.*\.properties$</file-name-pattern>
            <directories>$ISHOME</directories>
            <recursive>true</recursive>
            <exclude-share>true</exclude-share>
            <synchronize>true</synchronize>
            <compression-mode>complete-data-directory</compression-mode>
            <init-schedule>
                <run-time>2006.01.16 at 04:30:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>1</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>


        <aggregator>
            <name>ReportConfig</name>
            <description>Export the report configuation</description>
            <class>com.intershop.beehive.report.internal.aggregators.FileAggregator</class>
            <scope>cluster</scope>
            <file-name-pattern>report-config\.xml$</file-name-pattern>
            <directories>$ISSHAREDIR/system/config/cluster</directories>
            <recursive>false</recursive>
            <synchronize>true</synchronize>
            <compression-mode>single-files</compression-mode>
            <init-schedule>
                <run-time>2006.01.16 at 04:35:00</run-time>
                <recurrence-pattern>
                    <in>minutes</in>
                    <every>60</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>SoldProductsDaily</name>
            <description>Export statistics on sold products (daily)</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
              select sum("QUANTITYVALUE") as "QUANTITY",sum(T2."NETPRICEPCVALUE") AS NETPRICEPCVALUE,
                     T2."PRODUCTNAME",
                     T2."OFFERPRODUCTREFPRODUCTSKU",
                     T3."DOMAINNAME"
                from "ISORDER" T1,
                     "PRODUCTLINEITEM" T2,
                     "DOMAININFORMATION" T3
                where (T1."UUID" = T2."LINEITEMCTNRID")
                  and (T3."DOMAINID" = T1."DOMAINID")
                  and (T1."CREATIONDATE" between #AGGREGATION_BEGIN_DATE# and #AGGREGATION_END_DATE#)
                  and (T1."ORDERTYPE" = 0)
             group by "PRODUCTNAME", "OFFERPRODUCTREFPRODUCTSKU", "DOMAINNAME"
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>day</aggregation-level>
            <max-aggregation-periods>21</max-aggregation-periods>
            <max-data-files>32</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.16 at 04:25:00</run-time>
                <recurrence-pattern>
                    <in>minutes</in>
                    <every>1440</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>SoldProductsMonthly</name>
            <description>Export statistics on sold products (monthly)</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
              select sum("QUANTITYVALUE") as "QUANTITY",sum(T2."NETPRICEPCVALUE") AS NETPRICEPCVALUE,
                     T2."PRODUCTNAME",
                     T2."OFFERPRODUCTREFPRODUCTSKU",
                     T3."DOMAINNAME"
                from "ISORDER" T1,
                     "PRODUCTLINEITEM" T2,
                     "DOMAININFORMATION" T3
                where (T1."UUID" = T2."LINEITEMCTNRID")
                  and (T3."DOMAINID" = T1."DOMAINID")
                  and (T1."CREATIONDATE" between #AGGREGATION_BEGIN_DATE# and #AGGREGATION_END_DATE#)
                  and (T1."ORDERTYPE" = 0)
             group by "PRODUCTNAME", "OFFERPRODUCTREFPRODUCTSKU", "DOMAINNAME"
             having sum("QUANTITYVALUE")>5
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>month</aggregation-level>
            <max-aggregation-periods>2</max-aggregation-periods>
            <max-data-files>3</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.01 at 03:40:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>31</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>OrderVolumeDaily</name>
            <description>Export statistics on orders (daily)</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
                select sum(T1."GRANDTOTALNETPRICELCVALUE") as GRANDTOTALNETPRICELCVALUE,
                       sum(T1."GRANDTOTALNETPRICEPCVALUE") as GRANDTOTALNETPRICEPCVALUE,
                       sum(T1."GRANDTOTALTAXLCVALUE") as GRANDTOTALTAXLCVALUE,
                       sum(T1."GRANDTOTALTAXPCVALUE") as GRANDTOTALTAXPCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICELCVALUE") as GRANDTOTALGROSSPRICELCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICEPCVALUE") as GRANDTOTALGROSSPRICEPCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICEPTCVALUE")as GRANDTOTALGROSSPRICEPTCVALUE,
                       T3."DOMAINNAME",
                       T1."GRANDTOTALNETPRICELCCODE"
                from "ISORDER" T1,
                     "DOMAININFORMATION" T3
                where (T3."DOMAINID" = T1."DOMAINID")
                  and (T1."CREATIONDATE" between #AGGREGATION_BEGIN_DATE# and #AGGREGATION_END_DATE#)
                  and (T1."ORDERTYPE" = 0)
                group by "DOMAINNAME","GRANDTOTALNETPRICELCCODE"
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>day</aggregation-level>
            <max-aggregation-periods>21</max-aggregation-periods>
            <max-data-files>32</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.16 at 04:40:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>1</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>OrderVolumeMonthly</name>
            <description>Export statistics on orders (monthly)</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
                select sum(T1."GRANDTOTALNETPRICELCVALUE") as GRANDTOTALNETPRICELCVALUE,
                       sum(T1."GRANDTOTALNETPRICEPCVALUE") as GRANDTOTALNETPRICEPCVALUE,
                       sum(T1."GRANDTOTALTAXLCVALUE") as GRANDTOTALTAXLCVALUE,
                       sum(T1."GRANDTOTALTAXPCVALUE") as GRANDTOTALTAXPCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICELCVALUE") as GRANDTOTALGROSSPRICELCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICEPCVALUE") as GRANDTOTALGROSSPRICEPCVALUE,
                       sum(T1."GRANDTOTALGROSSPRICEPTCVALUE")as GRANDTOTALGROSSPRICEPTCVALUE,
                       T3."DOMAINNAME",
                       T1."GRANDTOTALNETPRICELCCODE"
                from "ISORDER" T1,
                     "DOMAININFORMATION" T3
                where (T3."DOMAINID" = T1."DOMAINID")
                  and (T1."CREATIONDATE" between #AGGREGATION_BEGIN_DATE# and #AGGREGATION_END_DATE#)
                  and (T1."ORDERTYPE" = 0)
                group by "DOMAINNAME","GRANDTOTALNETPRICELCCODE"
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>month</aggregation-level>
            <max-aggregation-periods>2</max-aggregation-periods>
            <max-data-files>3</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.01 at 04:55:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>31</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>
        <aggregator>
            <name>DomainList</name>
            <description>Export the list of domains with their UUID</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
                select DOMAINID,DOMAINNAME from DOMAININFORMATION
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>day</aggregation-level>
            <max-aggregation-periods>1</max-aggregation-periods>
            <max-data-files>10</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2004.01.16 at 04:41:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>7</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>AllCatalog</name>
            <description>Export the catalog (domain,category names and structure)</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
                select DOMAINID,uuid, name, nvl(PARENTCATEGORYID,'-')PARENTCATEGORYID from catalogcategory
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>day</aggregation-level>
            <max-aggregation-periods>1</max-aggregation-periods>
            <max-data-files>3</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.16 at 03:30:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>7</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

        <aggregator>
            <name>AllProducts</name>
            <description>Export a list of all products</description>
            <class>com.intershop.beehive.report.internal.aggregators.DatabaseAggregator</class>
            <sql-query>
             select p.DOMAINID, p.uuid, p.SKU, extractValue(XMLType(nvl(p.attributes_en_us, '&lt;attrs/&gt;')), '/attrs/attr[@name="name"]/string') as name from product p
            </sql-query>
            <data-source-id>beehive:comp/env/jdbc/report/defaultDB</data-source-id>
            <aggregation-level>day</aggregation-level>
            <max-aggregation-periods>1</max-aggregation-periods>
            <max-data-files>3</max-data-files>
            <compression-mode>single-files</compression-mode>
            <result-xml-indenting>false</result-xml-indenting>
            <result-xml-encoding>ISO-8859-1</result-xml-encoding>
            <init-schedule>
                <run-time>2006.01.16 at 03:20:00</run-time>
                <recurrence-pattern>
                    <in>days</in>
                    <every>7</every>
                </recurrence-pattern>
            </init-schedule>
        </aggregator>

    </aggregators>

    <transfer>
        <pipeline>SSHTransfer-Start</pipeline>
        <init-schedule>
            <run-time>2006.01.16 at 05:20:00</run-time>
            <recurrence-pattern>
                <in>minutes</in>
                <every>1440</every>
            </recurrence-pattern>
        </init-schedule>
    </transfer>

</report-config>
